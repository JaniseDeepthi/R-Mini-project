# Numeric columns: replace NA with mean
num_cols <- sapply(data, is.numeric)
for (col in names(data)[num_cols]) {
data[[col]][is.na(data[[col]])] <- mean(data[[col]], na.rm = TRUE)
}
# Categorical columns: replace NA with most frequent (mode)
for (col in names(data)[!num_cols]) {
mode_val <- names(sort(table(data[[col]]), decreasing = TRUE))[1]
data[[col]][is.na(data[[col]])] <- mode_val
}
cat("✅ Missing values handled (mean for numeric, mode for categorical)\n")
# Step 6: Standardization -----------------------------
data_standard <- data
data_standard[num_cols] <- scale(data[num_cols])
cat("✅ Standardization complete (mean=0, sd=1)\n")
# Step 7: Calculate Means -----------------------------
raw_means <- colMeans(data[num_cols])
std_means <- colMeans(data_standard[num_cols])
raw_df <- data.frame(Feature = names(raw_means), MeanValue = raw_means)
std_df <- data.frame(Feature = names(std_means), MeanValue = std_means)
compare_df <- data.frame(
Feature = rep(names(raw_means), 2),
MeanValue = c(raw_means, std_means),
Type = rep(c("Raw","Preprocessed"), each = length(raw_means))
)
# -------------------------------
# Graph 1: Raw Data
ggplot(raw_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Raw Data (Feature Means)", x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# -------------------------------
# Graph 2: Preprocessed Data
ggplot(std_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Preprocessed Data (After Missing Value Handling + Standardization)",
x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# ================================
# Waste Management Dataset - Raw vs Preprocessed (Bar Charts)
# ================================
# Step 1: Install packages (run only once)
# install.packages(c("synthpop","dplyr","ggplot2"))
# Step 2: Load libraries
library(synthpop)
library(dplyr)
library(ggplot2)
# Step 3: Create a synthetic dataset
set.seed(123)
real_data <- data.frame(
Zone = as.factor(sample(c("North","South","East","West"), 500, replace = TRUE)),
Population = sample(5000:15000, 500, replace = TRUE),
Waste_Generated_kg = round(runif(500, 300, 8000), 1),
Recycled_kg = round(runif(500, 100, 4000), 1),
Organic_Percent = round(runif(500, 10, 90), 1),
Plastic_Percent = round(runif(500, 5, 60), 1),
Collection_Frequency = sample(1:7, 500, replace = TRUE),
Smart_Bins_Used = as.factor(sample(c("Yes","No"), 500, replace = TRUE)),
Complaint_Count = sample(0:30, 500, replace = TRUE),
Sensor_Failure_Rate = round(runif(500, 0.00, 0.25), 2)
)
# Generate synthetic data
synthetic_data <- syn(real_data)$syn
write.csv(synthetic_data, "synthetic_waste_mgmt_data.csv", row.names = FALSE)
# Step 3: Load dataset --------------------------------
data <- read.csv("synthetic_waste_mgmt_data.csv")
# Step 4: Introduce some missing values (for demo) ----
set.seed(42)
data$Complaint_Count[sample(1:500, 15)] <- NA
data$Sensor_Failure_Rate[sample(1:500, 10)] <- NA
# Step 5: Missing Value Handling ----------------------
# Numeric columns: replace NA with mean
num_cols <- sapply(data, is.numeric)
for (col in names(data)[num_cols]) {
data[[col]][is.na(data[[col]])] <- mean(data[[col]], na.rm = TRUE)
}
# Categorical columns: replace NA with most frequent (mode)
for (col in names(data)[!num_cols]) {
mode_val <- names(sort(table(data[[col]]), decreasing = TRUE))[1]
data[[col]][is.na(data[[col]])] <- mode_val
}
cat("✅ Missing values handled (mean for numeric, mode for categorical)\n")
# Step 6: Standardization -----------------------------
data_standard <- data
data_standard[num_cols] <- scale(data[num_cols])
cat("✅ Standardization complete (mean=0, sd=1)\n")
# Step 7: Calculate Means -----------------------------
raw_means <- colMeans(data[num_cols])
std_means <- colMeans(data_standard[num_cols])
raw_df <- data.frame(Feature = names(raw_means), MeanValue = raw_means)
std_df <- data.frame(Feature = names(std_means), MeanValue = std_means)
compare_df <- data.frame(
Feature = rep(names(raw_means), 2),
MeanValue = c(raw_means, std_means),
Type = rep(c("Raw","Preprocessed"), each = length(raw_means))
)
# -------------------------------
# Graph 1: Raw Data
ggplot(raw_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Raw Data (Feature Means)", x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# -------------------------------
# Graph 2: Preprocessed Data
ggplot(std_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Preprocessed Data (After Missing Value Handling + Standardization)",
x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# -------------------------------
# Graph 3: Comparison
ggplot(compare_df, aes(x=Feature, y=MeanValue, fill=Type)) +
geom_bar(stat="identity", position="dodge") +
labs(title="Comparison: Raw vs Preprocessed Data",
x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual(values=c("Raw"="tomato","Preprocessed"="steelblue"))
# Step 1: Install required packages (only run once)
install.packages("synthpop")
install.packages("dplyr")
# Step 2: Load the necessary libraries
library(synthpop)
library(dplyr)
# Step 3: Create a mock "real" dataset (used to train the GAN-style generator)
set.seed(123)  # Reproducibility
real_data <- data.frame(
Zone = as.factor(sample(c("North", "South", "East", "West"), 500, replace = TRUE)),
Population = sample(5000:15000, 500, replace = TRUE),
Waste_Generated_kg = round(runif(500, 300, 8000), 1),
Recycled_kg = round(runif(500, 100, 4000), 1),
Organic_Percent = round(runif(500, 10, 90), 1),
Plastic_Percent = round(runif(500, 5, 60), 1),
Collection_Frequency = sample(1:7, 500, replace = TRUE),  # Days/week
Smart_Bins_Used = as.factor(sample(c("Yes", "No"), 500, replace = TRUE)),
Complaint_Count = sample(0:30, 500, replace = TRUE),
Sensor_Failure_Rate = round(runif(500, 0.00, 0.25), 2)
)
# Step 4: Generate synthetic data using GAN-like tabular synthesis (synthpop)
synthetic_data <- syn(real_data)$syn
# Step 5: Save the synthetic dataset to a CSV file
write.csv(synthetic_data, "synthetic_waste_mgmt_data.csv", row.names = FALSE)
# Step 6: View confirmation
cat("✅ Synthetic dataset 'synthetic_waste_mgmt_data.csv' created successfully with 500 rows and 10 columns.\n")
# Optional: View first few rows
head(synthetic_data)
summary(data)
# ================================
# Waste Management Dataset - Raw vs Preprocessed
# ================================
# Step 1: Install packages (only first time)
# install.packages(c("synthpop","dplyr","ggplot2","reshape2"))
# Step 2: Load libraries
library(synthpop)
library(dplyr)
library(ggplot2)
library(reshape2)
# Step 3: Create a synthetic dataset
set.seed(123)
real_data <- data.frame(
Zone = as.factor(sample(c("North","South","East","West"), 500, replace = TRUE)),
Population = sample(5000:15000, 500, replace = TRUE),
Waste_Generated_kg = round(runif(500, 300, 8000), 1),
Recycled_kg = round(runif(500, 100, 4000), 1),
Organic_Percent = round(runif(500, 10, 90), 1),
Plastic_Percent = round(runif(500, 5, 60), 1),
Collection_Frequency = sample(1:7, 500, replace = TRUE),
Smart_Bins_Used = as.factor(sample(c("Yes","No"), 500, replace = TRUE)),
Complaint_Count = sample(0:30, 500, replace = TRUE),
Sensor_Failure_Rate = round(runif(500, 0.00, 0.25), 2)
)
# Generate synthetic data (GAN-like synthesis with synthpop)
synthetic_data <- syn(real_data)$syn
# Save dataset
write.csv(synthetic_data, "synthetic_waste_mgmt_data.csv", row.names = FALSE)
cat("✅ Synthetic dataset created & saved as CSV\n")
summary(data)
# Step 3: Load dataset --------------------------------
data <- read.csv("synthetic_waste_mgmt_data.csv")
# Step 4: Introduce some missing values (for demo) ----
set.seed(42)
data$Complaint_Count[sample(1:500, 15)] <- NA
data$Sensor_Failure_Rate[sample(1:500, 10)] <- NA
# Step 5: Missing Value Handling ----------------------
# Numeric columns: replace NA with mean
num_cols <- sapply(data, is.numeric)
for (col in names(data)[num_cols]) {
data[[col]][is.na(data[[col]])] <- mean(data[[col]], na.rm = TRUE)
}
# Categorical columns: replace NA with most frequent (mode)
for (col in names(data)[!num_cols]) {
mode_val <- names(sort(table(data[[col]]), decreasing = TRUE))[1]
data[[col]][is.na(data[[col]])] <- mode_val
}
cat("✅ Missing values handled (mean for numeric, mode for categorical)\n")
# Step 6: Standardization -----------------------------
data_standard <- data
data_standard[num_cols] <- scale(data[num_cols])
cat("✅ Standardization complete (mean=0, sd=1)\n")
# Step 7: Calculate Means -----------------------------
raw_means <- colMeans(data[num_cols])
std_means <- colMeans(data_standard[num_cols])
raw_df <- data.frame(Feature = names(raw_means), MeanValue = raw_means)
std_df <- data.frame(Feature = names(std_means), MeanValue = std_means)
compare_df <- data.frame(
Feature = rep(names(raw_means), 2),
MeanValue = c(raw_means, std_means),
Type = rep(c("Raw","Preprocessed"), each = length(raw_means))
)
# -------------------------------
# Graph 1: Raw Data
ggplot(raw_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Raw Data (Feature Means)", x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# -------------------------------
# Graph 2: Preprocessed Data
ggplot(std_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Preprocessed Data (After Missing Value Handling + Standardization)",
x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# -------------------------------
# Graph 3: Comparison
ggplot(compare_df, aes(x=Feature, y=MeanValue, fill=Type)) +
geom_bar(stat="identity", position="dodge") +
labs(title="Comparison: Raw vs Preprocessed Data",
x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual(values=c("Raw"="tomato","Preprocessed"="steelblue"))
# Step 1: Install required packages (only run once)
install.packages("synthpop")
install.packages("dplyr")
# Step 2: Load the necessary libraries
library(synthpop)
library(dplyr)
# Step 3: Create a mock "real" dataset (used to train the GAN-style generator)
set.seed(123)  # Reproducibility
real_data <- data.frame(
Zone = as.factor(sample(c("North", "South", "East", "West"), 500, replace = TRUE)),
Population = sample(5000:15000, 500, replace = TRUE),
Waste_Generated_kg = round(runif(500, 300, 8000), 1),
Recycled_kg = round(runif(500, 100, 4000), 1),
Organic_Percent = round(runif(500, 10, 90), 1),
Plastic_Percent = round(runif(500, 5, 60), 1),
Collection_Frequency = sample(1:7, 500, replace = TRUE),  # Days/week
Smart_Bins_Used = as.factor(sample(c("Yes", "No"), 500, replace = TRUE)),
Complaint_Count = sample(0:30, 500, replace = TRUE),
Sensor_Failure_Rate = round(runif(500, 0.00, 0.25), 2)
)
# Step 4: Generate synthetic data using GAN-like tabular synthesis (synthpop)
synthetic_data <- syn(real_data)$syn
# Step 5: Save the synthetic dataset to a CSV file
write.csv(synthetic_data, "synthetic_waste_mgmt_data.csv", row.names = FALSE)
# Step 6: View confirmation
cat("✅ Synthetic dataset 'synthetic_waste_mgmt_data.csv' created successfully with 500 rows and 10 columns.\n")
# Optional: View first few rows
head(synthetic_data)
summary(data)
# Step 3: Load dataset --------------------------------
data <- read.csv("synthetic_waste_mgmt_data.csv")
# Step 4: Introduce some missing values (for demo) ----
set.seed(42)
data$Complaint_Count[sample(1:500, 15)] <- NA
data$Sensor_Failure_Rate[sample(1:500, 10)] <- NA
# Step 5: Missing Value Handling ----------------------
# Numeric columns: replace NA with mean
num_cols <- sapply(data, is.numeric)
for (col in names(data)[num_cols]) {
data[[col]][is.na(data[[col]])] <- mean(data[[col]], na.rm = TRUE)
}
# Categorical columns: replace NA with most frequent (mode)
for (col in names(data)[!num_cols]) {
mode_val <- names(sort(table(data[[col]]), decreasing = TRUE))[1]
data[[col]][is.na(data[[col]])] <- mode_val
}
cat("✅ Missing values handled (mean for numeric, mode for categorical)\n")
# Step 6: Standardization -----------------------------
data_standard <- data
data_standard[num_cols] <- scale(data[num_cols])
cat("✅ Standardization complete (mean=0, sd=1)\n")
# Step 7: Calculate Means -----------------------------
raw_means <- colMeans(data[num_cols])
std_means <- colMeans(data_standard[num_cols])
raw_df <- data.frame(Feature = names(raw_means), MeanValue = raw_means)
std_df <- data.frame(Feature = names(std_means), MeanValue = std_means)
compare_df <- data.frame(
Feature = rep(names(raw_means), 2),
MeanValue = c(raw_means, std_means),
Type = rep(c("Raw","Preprocessed"), each = length(raw_means))
)
# -------------------------------
# Graph 1: Raw Data
ggplot(raw_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Raw Data (Feature Means)", x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# -------------------------------
# Graph 2: Preprocessed Data
ggplot(std_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Preprocessed Data (After Missing Value Handling + Standardization)",
x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# -------------------------------
# Graph 3: Comparison
ggplot(compare_df, aes(x=Feature, y=MeanValue, fill=Type)) +
geom_bar(stat="identity", position="dodge") +
labs(title="Comparison: Raw vs Preprocessed Data",
x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
scale_fill_manual(values=c("Raw"="tomato","Preprocessed"="steelblue"))
# Step 1: Install required packages (only run once)
install.packages("synthpop")
install.packages("dplyr")
# Step 2: Load the necessary libraries
library(synthpop)
library(dplyr)
# Step 3: Create a mock "real" dataset (used to train the GAN-style generator)
set.seed(123)  # Reproducibility
real_data <- data.frame(
Zone = as.factor(sample(c("North", "South", "East", "West"), 500, replace = TRUE)),
Population = sample(5000:15000, 500, replace = TRUE),
Waste_Generated_kg = round(runif(500, 300, 8000), 1),
Recycled_kg = round(runif(500, 100, 4000), 1),
Organic_Percent = round(runif(500, 10, 90), 1),
Plastic_Percent = round(runif(500, 5, 60), 1),
Collection_Frequency = sample(1:7, 500, replace = TRUE),  # Days/week
Smart_Bins_Used = as.factor(sample(c("Yes", "No"), 500, replace = TRUE)),
Complaint_Count = sample(0:30, 500, replace = TRUE),
Sensor_Failure_Rate = round(runif(500, 0.00, 0.25), 2)
)
# Step 4: Generate synthetic data using GAN-like tabular synthesis (synthpop)
synthetic_data <- syn(real_data)$syn
# Step 5: Save the synthetic dataset to a CSV file
write.csv(synthetic_data, "synthetic_waste_mgmt_data.csv", row.names = FALSE)
# Step 6: View confirmation
cat("✅ Synthetic dataset 'synthetic_waste_mgmt_data.csv' created successfully with 500 rows and 10 columns.\n")
# Optional: View first few rows
head(synthetic_data)
summary(data)
# Step 3: Load dataset --------------------------------
data <- read.csv("synthetic_waste_mgmt_data.csv")
# Step 4: Introduce some missing values (for demo) ----
set.seed(42)
data$Complaint_Count[sample(1:500, 15)] <- NA
data$Sensor_Failure_Rate[sample(1:500, 10)] <- NA
# Step 5: Missing Value Handling ----------------------
# Numeric columns: replace NA with mean
num_cols <- sapply(data, is.numeric)
for (col in names(data)[num_cols]) {
data[[col]][is.na(data[[col]])] <- mean(data[[col]], na.rm = TRUE)
}
# Categorical columns: replace NA with most frequent (mode)
for (col in names(data)[!num_cols]) {
mode_val <- names(sort(table(data[[col]]), decreasing = TRUE))[1]
data[[col]][is.na(data[[col]])] <- mode_val
}
cat("✅ Missing values handled (mean for numeric, mode for categorical)\n")
# Step 6: Standardization -----------------------------
data_standard <- data
data_standard[num_cols] <- scale(data[num_cols])
cat("✅ Standardization complete (mean=0, sd=1)\n")
# Step 7: Calculate Means -----------------------------
raw_means <- colMeans(data[num_cols])
std_means <- colMeans(data_standard[num_cols])
raw_df <- data.frame(Feature = names(raw_means), MeanValue = raw_means)
std_df <- data.frame(Feature = names(std_means), MeanValue = std_means)
compare_df <- data.frame(
Feature = rep(names(raw_means), 2),
MeanValue = c(raw_means, std_means),
Type = rep(c("Raw","Preprocessed"), each = length(raw_means))
)
# -------------------------------
# Graph 1: Raw Data
ggplot(raw_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Raw Data (Feature Means)", x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# Step 1: Install required packages (only run once)
install.packages("synthpop")
install.packages("dplyr")
# Step 2: Load the necessary libraries
library(synthpop)
library(dplyr)
# Step 3: Create a mock "real" dataset (used to train the GAN-style generator)
set.seed(123)  # Reproducibility
real_data <- data.frame(
Zone = as.factor(sample(c("North", "South", "East", "West"), 500, replace = TRUE)),
Population = sample(5000:15000, 500, replace = TRUE),
Waste_Generated_kg = round(runif(500, 300, 8000), 1),
Recycled_kg = round(runif(500, 100, 4000), 1),
Organic_Percent = round(runif(500, 10, 90), 1),
Plastic_Percent = round(runif(500, 5, 60), 1),
Collection_Frequency = sample(1:7, 500, replace = TRUE),  # Days/week
Smart_Bins_Used = as.factor(sample(c("Yes", "No"), 500, replace = TRUE)),
Complaint_Count = sample(0:30, 500, replace = TRUE),
Sensor_Failure_Rate = round(runif(500, 0.00, 0.25), 2)
)
# Step 4: Generate synthetic data using GAN-like tabular synthesis (synthpop)
synthetic_data <- syn(real_data)$syn
# Step 5: Save the synthetic dataset to a CSV file
write.csv(synthetic_data, "synthetic_waste_mgmt_data.csv", row.names = FALSE)
# Step 6: View confirmation
cat("✅ Synthetic dataset 'synthetic_waste_mgmt_data.csv' created successfully with 500 rows and 10 columns.\n")
# Optional: View first few rows
head(synthetic_data)
summary(data)
# Step 3: Load dataset --------------------------------
data <- read.csv("synthetic_waste_mgmt_data.csv")
# Step 4: Introduce some missing values (for demo) ----
set.seed(42)
data$Complaint_Count[sample(1:500, 15)] <- NA
data$Sensor_Failure_Rate[sample(1:500, 10)] <- NA
# Step 5: Missing Value Handling ----------------------
# Numeric columns: replace NA with mean
num_cols <- sapply(data, is.numeric)
for (col in names(data)[num_cols]) {
data[[col]][is.na(data[[col]])] <- mean(data[[col]], na.rm = TRUE)
}
# Categorical columns: replace NA with most frequent (mode)
for (col in names(data)[!num_cols]) {
mode_val <- names(sort(table(data[[col]]), decreasing = TRUE))[1]
data[[col]][is.na(data[[col]])] <- mode_val
}
cat("✅ Missing values handled (mean for numeric, mode for categorical)\n")
# Step 6: Standardization -----------------------------
data_standard <- data
data_standard[num_cols] <- scale(data[num_cols])
cat("✅ Standardization complete (mean=0, sd=1)\n")
# Step 7: Calculate Means -----------------------------
raw_means <- colMeans(data[num_cols])
std_means <- colMeans(data_standard[num_cols])
raw_df <- data.frame(Feature = names(raw_means), MeanValue = raw_means)
std_df <- data.frame(Feature = names(std_means), MeanValue = std_means)
compare_df <- data.frame(
Feature = rep(names(raw_means), 2),
MeanValue = c(raw_means, std_means),
Type = rep(c("Raw","Preprocessed"), each = length(raw_means))
)
# -------------------------------
# Graph 1: Raw Data
ggplot(raw_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Raw Data (Feature Means)", x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
# Step 1: Install required packages (only run once)
install.packages("synthpop")
install.packages("dplyr")
# Step 2: Load the necessary libraries
library(synthpop)
library(dplyr)
# Step 3: Create a mock "real" dataset (used to train the GAN-style generator)
set.seed(123)  # Reproducibility
real_data <- data.frame(
Zone = as.factor(sample(c("North", "South", "East", "West"), 500, replace = TRUE)),
Population = sample(5000:15000, 500, replace = TRUE),
Waste_Generated_kg = round(runif(500, 300, 8000), 1),
Recycled_kg = round(runif(500, 100, 4000), 1),
Organic_Percent = round(runif(500, 10, 90), 1),
Plastic_Percent = round(runif(500, 5, 60), 1),
Collection_Frequency = sample(1:7, 500, replace = TRUE),  # Days/week
Smart_Bins_Used = as.factor(sample(c("Yes", "No"), 500, replace = TRUE)),
Complaint_Count = sample(0:30, 500, replace = TRUE),
Sensor_Failure_Rate = round(runif(500, 0.00, 0.25), 2)
)
# Step 4: Generate synthetic data using GAN-like tabular synthesis (synthpop)
synthetic_data <- syn(real_data)$syn
# Step 5: Save the synthetic dataset to a CSV file
write.csv(synthetic_data, "synthetic_waste_mgmt_data.csv", row.names = FALSE)
# Step 6: View confirmation
cat("✅ Synthetic dataset 'synthetic_waste_mgmt_data.csv' created successfully with 500 rows and 10 columns.\n")
# Optional: View first few rows
head(synthetic_data)
summary(data)
# Step 3: Load dataset --------------------------------
data <- read.csv("synthetic_waste_mgmt_data.csv")
# Step 4: Introduce some missing values (for demo) ----
set.seed(42)
data$Complaint_Count[sample(1:500, 15)] <- NA
data$Sensor_Failure_Rate[sample(1:500, 10)] <- NA
# Step 5: Missing Value Handling ----------------------
# Numeric columns: replace NA with mean
num_cols <- sapply(data, is.numeric)
for (col in names(data)[num_cols]) {
data[[col]][is.na(data[[col]])] <- mean(data[[col]], na.rm = TRUE)
}
# Categorical columns: replace NA with most frequent (mode)
for (col in names(data)[!num_cols]) {
mode_val <- names(sort(table(data[[col]]), decreasing = TRUE))[1]
data[[col]][is.na(data[[col]])] <- mode_val
}
cat("✅ Missing values handled (mean for numeric, mode for categorical)\n")
# Step 6: Standardization -----------------------------
data_standard <- data
data_standard[num_cols] <- scale(data[num_cols])
cat("✅ Standardization complete (mean=0, sd=1)\n")
# Step 7: Calculate Means -----------------------------
raw_means <- colMeans(data[num_cols])
std_means <- colMeans(data_standard[num_cols])
raw_df <- data.frame(Feature = names(raw_means), MeanValue = raw_means)
std_df <- data.frame(Feature = names(std_means), MeanValue = std_means)
compare_df <- data.frame(
Feature = rep(names(raw_means), 2),
MeanValue = c(raw_means, std_means),
Type = rep(c("Raw","Preprocessed"), each = length(raw_means))
)
# -------------------------------
# Graph 1: Raw Data
ggplot(raw_df, aes(x=Feature, y=MeanValue, fill=Feature)) +
geom_bar(stat="identity") +
labs(title="Raw Data (Feature Means)", x="Features", y="Mean Value") +
theme(axis.text.x = element_text(angle=45, hjust=1))
